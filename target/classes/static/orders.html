<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Orders · Neo</title>
  <style>
    :root{--bg:#f6f7f9;--ink:#111827;--primary:#93c5fd;--primary-ink:#0f172a;--accent:#ffd803;--danger:#ff6b6b;--card:#fff;--shadow:6px 6px 0 #111827;--radius:10px;--border:3px solid #111827}
    *{box-sizing:border-box}
    body{font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,sans-serif;margin:40px;color:var(--ink);background:var(--bg);background-image:linear-gradient(90deg,rgba(0,0,0,.04) 1px,transparent 1px),linear-gradient(0deg,rgba(0,0,0,.04) 1px,transparent 1px);background-size:24px 24px}
    .wrap{max-width:1200px;margin:0 auto}
    .title{display:inline-block;padding:10px 16px;background:var(--accent);border:var(--border);border-radius:var(--radius);box-shadow:var(--shadow);margin:0 0 20px 0}
    .panel{background:var(--card);border:var(--border);border-radius:var(--radius);box-shadow:var(--shadow);padding:18px;margin-bottom:20px}
    .row{display:flex;gap:10px;flex-wrap:wrap}
    input{padding:12px 14px;border:var(--border);border-radius:var(--radius);box-shadow:var(--shadow);outline:none;background:#fff;min-width:200px}
    button,.btn{padding:12px 16px;border:var(--border);border-radius:var(--radius);box-shadow:var(--shadow);cursor:pointer;background:var(--primary);color:var(--primary-ink);text-decoration:none;display:inline-block;margin:4px 6px 6px 0}
    .btn-accent{background:var(--accent);color:#111827}
    .btn-danger{background:var(--danger)}
    table{width:100%;border-collapse:separate;border-spacing:0}
    thead th{background:#e5e7eb;text-align:left;padding:12px;border-top:var(--border);border-bottom:var(--border);border-left:var(--border)}
    thead th:last-child{border-right:var(--border)}
    tbody td{padding:12px;border-left:var(--border);border-bottom:var(--border);background:#fff}
    tbody tr td:last-child{border-right:var(--border)}
    .muted{color:#6b7280}
    button:active,.btn:active{transform:translate(3px,3px);box-shadow:3px 3px 0 #111827}
  </style>
</head>
<body>
  <div class="wrap">
    <h1 class="title">Orders</h1>
    <p class="muted">Lab 09–10 UI · <a class="btn" href="/">Trang chủ</a> · <a class="btn" href="/products.html">Products</a> · <a class="btn" href="/account.html">Account</a></p>
    <div class="panel">
      <div class="row">
        <input id="productId" placeholder="Product ID" />
        <input id="quantity" placeholder="Số lượng" type="number" step="1" />
        <button id="add" class="btn-accent">Thêm</button>
      </div>
    </div>
    <div class="panel">
      <table>
        <thead>
          <tr><th>ID</th><th>ProductId</th><th>Quantity</th><th>Hành động</th></tr>
        </thead>
        <tbody id="tbody"></tbody>
      </table>
    </div>
  </div>

  <script>
    const API = '/api/orders';
    async function fetchJSON(url, options){
      const res = await fetch(url, {headers:{'Content-Type':'application/json'}, ...options});
      if(!res.ok) throw new Error(await res.text());
      return res.status !== 204 ? res.json() : null;
    }
    async function load(){
      const data = await fetchJSON(API);
      const tbody = document.getElementById('tbody');
      tbody.innerHTML = '';
      data.forEach(o => {
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${o.id}</td>
          <td><input data-id="${o.id}" class="pid" value="${o.productId||''}" /></td>
          <td><input data-id="${o.id}" class="qty" type="number" step="1" value="${o.quantity||0}" /></td>
          <td>
            <button class="save" data-id="${o.id}">Lưu</button>
            <button class="del btn-danger" data-id="${o.id}">Xoá</button>
          </td>`;
        tbody.appendChild(tr);
      });
    }
    async function add(){
      const productId = document.getElementById('productId').value.trim();
      const quantity = parseInt(document.getElementById('quantity').value||'0',10);
      if(!productId) return;
      await fetchJSON(API,{method:'POST', body: JSON.stringify({productId, quantity})});
      document.getElementById('productId').value='';
      document.getElementById('quantity').value='';
      load();
    }
    async function save(id){
      const pid = document.querySelector(`input.pid[data-id="${id}"]`).value.trim();
      const qty = parseInt(document.querySelector(`input.qty[data-id="${id}"]`).value||'0',10);
      await fetchJSON(`${API}/${id}`,{method:'PUT', body: JSON.stringify({productId:pid, quantity:qty})});
      load();
    }
    async function del(id){
      await fetchJSON(`${API}/${id}`,{method:'DELETE'});
      load();
    }
    document.getElementById('add').addEventListener('click', add);
    document.getElementById('tbody').addEventListener('click', (e)=>{
      const t=e.target; const id=t.dataset.id;
      if(t.classList.contains('save')) save(id);
      if(t.classList.contains('del')) del(id);
    });
    load().catch(console.error);
  </script>
</body>
</html>


